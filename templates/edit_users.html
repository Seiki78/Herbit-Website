<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    <title>ข้อมูลยาสมุนไพร</title>
</head> 
<body>
    
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-overlay alert-{{ category }} hidden">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <section id="sidebar">
        <a href="" class="brand">
            <i class='bx bxs-smile'><img src="{{ url_for('static', filename='herbs_icon01.png') }}" class="icon-mini" alt="Menu Icon"></i>
			<span class="text">Mongo</span>
		</a>
		<ul class="side-menu top">
			<li>
				<a href="">
					<i class='bx bxs-dashboard' ><img src="{{ url_for('static', filename='dashboard.png') }}" class="icon-mini" alt="Menu Icon"></i>
					<span class="text">แดชบอร์ด</span>
				</a>
			</li>
            <li class="active">
				<a href="{{ url_for('manage_members') }}">
					<i class='bx bxs-shopping-bag-alt' ><img src="{{ url_for('static', filename='group.png') }}" class="icon-mini" alt="Menu Icon"></i>
					<span class="text">จัดการสมาชิก</span>
				</a>
			</li>
			<li>
				<a href="{{ url_for('manage_herbals') }}">
					<i class='bx bxs-shopping-bag-alt' ><img src="{{ url_for('static', filename='leaf_01.png') }}" class="icon-mini" alt="Menu Icon"></i>
					<span class="text">จัดการยาสมุนไพร</span>
				</a>
			</li>
			<li>
				<a href="{{ url_for('manage_medicines') }}">
					<i class='bx bxs-doughnut-chart' ><img src="{{ url_for('static', filename='medicine.png') }}" class="icon-mini" alt="Menu Icon"></i>
					<span class="text">จัดการข้อมูลยา</span>
				</a>
			</li>
			<li>
				<a href="{{ url_for('manage_chrosymps') }}">
					<i class='bx bxs-doughnut-chart' ><img src="{{ url_for('static', filename='prevent.png') }}" class="icon-mini" alt="Menu Icon"></i>
					<span class="text">จัดการข้อมูลโรคและอาการ</span>
				</a>
			</li>
            <li>
				<a href="{{ url_for('manage_allergys') }}">
					<i class='bx bxs-doughnut-chart' ><img src="{{ url_for('static', filename='no-milk.png') }}" class="icon-mini" alt="Menu Icon"></i>
					<span class="text">จัดการข้อมูลการแพ้</span>
				</a>
			</li>
            <li>
				<a href="{{ url_for('manage_trains') }}">
					<i class='bx bxs-doughnut-chart' ><img src="{{ url_for('static', filename='database.png') }}" class="icon-mini" alt="Menu Icon"></i>
					<span class="text">จัดการข้อมูล Training</span>
				</a>
			</li>
		</ul>
		<ul class="side-menu">
			<li>
				<a href="{{ url_for('logout') }}" class="logout">
					<i class='bx bxs-log-out-circle' ><img src="{{ url_for('static', filename='logout.png') }}" class="icon-mini" alt="Menu Icon"></i>
					<span class="text">ออกจากระบบ</span>
				</a>
			</li>
		</ul>

    </section>




    <section id="content">
<!-- NAVBAR -->
<nav>
    <!-- เมนูไอคอนอยู่ชิดซ้าย -->
    <i class='bx bx-menu'>
        <img src="{{ url_for('static', filename='menu-regular-24.png') }}" alt="Menu Icon">
    </i>
  
    <!-- โปรไฟล์ไอคอนอยู่ชิดขวา -->
    <a href="{{ url_for('manage_members') }}" class="profile">
        <img src="{{ url_for('static', filename='user_admin.png') }}">
    </a>
  </nav>
<!-- NAVBAR -->

<!-- MAIN -->
<main>
    <div class="head-title">
        <div class="left">
            <h1>ข้อมูลสมาชิก</h1>          
        </div>
    </div>

    <form action="{{ url_for('edit_user', user_id=user['_id']) }}" method="POST">

        <div class="table-data">

            <div class="order">
                <div class="head">
                    <h3>แก้ไขข้อมูลสมาชิก</h3>
                    <i class='bx bx-search' ></i>
                    <i class='bx bx-filter' ></i>
                </div>
                
                    <table>
                        <tr>
                            <td>
                                <label>ชื่อผู้ใช้</label>
                            </td>
                            <td>
                                <input type="text" name="username" value="{{ user['username'] }}" >
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label>อีเมล</label>
                            </td>
                            <td>
                                <input type="email" name="email" value="{{ user['Email'] }}" >
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label>รหัสผ่าน</label>
                            </td>
                            <td>
                                <a href="#" id="togglePasswordLink">แก้ไขรหัสผ่าน</a>
                            </td>
                        </tr>
                        <tr id="newPasswordRow" style="display:none;">
                            <td>
                                <label>รหัสผ่านใหม่</label>
                            </td>
                            <td>
                                <input type="password" name="new_password" placeholder="กรอกรหัสผ่านใหม่">
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label>ชื่อ</label>
                            </td>
                            <td>
                                <input type="text" name="fname" value="{{ user['fname'] }}" >
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label>นามสกุล</label>
                            </td>
                            <td>
                                <input type="text" name="lname" value="{{ user['lname'] }}" >
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label>เพศ</label>
                            </td>
                            <td>
                                <select name="gender" id="gender" onchange="toggleFemaleField()" required>
                                    <option value="" {% if train['gender'] is none %}selected{% endif %}>--เลือก--</option>
                                    <option value="0" {% if train['gender'] == 1 %}selected{% endif %}>ชาย</option>
                                    <option value="1" {% if train['gender'] == 1 %}selected{% endif %}>หญิง</option>
                                </select>
                            </td>
                        </tr>
                    </table><br>
                    <div id="FemaleField">
                        <ul>
                            <li>
                                <input id="pregnant" type="checkbox" name="pregnant" value="1" {% if train['pregnant'] == 1 %}checked{% endif %}>
                                <span>ตั้งครรภ์</span>
                                
                            </li>
                            <li>
                                <input id="breastfeeding" type="checkbox" name="breastfeeding" value="1" {% if train['breastfeeding'] == 1 %}checked{% endif %}>
                                <span>ให้นมบุตร</span>
                                
                            </li>
                        </ul>
                        
                    </div><br><br>
                    
                    <!-- <div class="head">
                        <div class="selected-list">
    
                            <table class="chronicsTable" id="selectedChronicsList">
                            <thead>
                                <tr>
                                    <th>โรคประจำตัว</th>
     
                                </tr>
                            </thead>
                            <tbody>
                                {% for chronic in existing_chronics %}
                                    <tr>
                                        <td>{{ chronic }}</td>
                                        <td></td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                        </div>
                        
                    </div>
    
                    <div class="head">
                        <select id="Chronics" name="Chronics" multiple>
                            <option value="">-- เลือก --</option>
                            {% for Chronic in Chronics %}
                                <option value="{{ Chronic[0] }}">{{ Chronic[1] }}</option> 
                                <-- Chronic[0] คือ Chronic_Disease และ Chronic[1] คือ Chronic_Disease_name -->
                            <!-- {% endfor %}
                        </select>
                        <button type="button" onclick="addSelected()">เพิ่ม</button>
                    </div>

                    <br> -->

                    <!-- <div class="head">
                        <div class="selected-list">
    
                            <table class="allergiesTable" id="selectedallergiesList">
                            <thead>
                                <tr>
                                    <th>ข้อมูลการแพ้</th>
     
                                </tr>
                            </thead>
                            <tbody>
                                {% for allergie in existing_allergies %}
                                    <tr>
                                        <td>{{ allergie }}</td>
                                        <td></td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                        </div>
                        
                    </div> -->
    
                    <!-- <div class="head">
                        <select id="allergie" name="allergies" multiple>
                            <option value="">-- เลือก --</option>
                            {% for allergie in allergies %}
                                <option value="{{ allergie[0] }}">{{ allergie[1] }}</option> 
                            {% endfor %}
                        </select>
                        <button type="button" onclick="addSelected()">เพิ่ม</button>
                    </div> -->

                    <!-- <div class="head">
                        <div class="selected-list">
    
                            <table class="chronicsTable" id="selectedChronicsList">
                            <thead>
                                <tr>
                                    <th>ยาที่ใช้</th>
     
                                </tr>
                            </thead>
                            <tbody>
                                {% for medicines in existing_medicines %}
                                    <tr>
                                        <td>{{ medicines }}</td>
                                        <td></td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                        </div>
                        
                    </div> -->
    
                    <!-- <div class="head">
                        <select id="medicines" name="medicines" multiple>
                            <option value="">-- เลือก --</option>
                            {% for medicine in medicines %}
                                <option value="{{ medicine[0] }}">{{ medicine[1] }} - {{ medicine[2] }}</option> 
                            {% endfor %}
                        </select>
                        <button type="button" onclick="addSelected()">เพิ่ม</button>
                    </div> -->


                    <button type="submit" class="submit-btn">
                        <img src="{{ url_for('static', filename='check_blue.png') }}" alt="Submit">
                    </button>

                
            </div>

        </div>

    </form>
    



</main>
<!-- MAIN -->

    </section>


    <script>
        document.querySelectorAll('input[type=checkbox]').forEach(checkbox => {
            checkbox.addEventListener('change', (event) => {
                event.target.value = event.target.checked ? "1" : "0";
            });
        }); // เพิ่ม event listener เมื่อค่า checkbox เปลี่ยนแปลง

        // ฟังก์ชัน toggleFemaleField() 
        function toggleFemaleField() {
            var genderSelect = document.getElementById("gender");
            var selectedValue = genderSelect.options[genderSelect.selectedIndex].value;
            var FemaleField = document.getElementById("FemaleField");
            if (selectedValue == "1") {
                FemaleField.style.display = "block";
            } else {
                FemaleField.style.display = "none";
            }
        }

        document.getElementById('togglePasswordLink').addEventListener('click', function(e) {
            e.preventDefault(); // ป้องกันการทำงานของลิงก์
            var newPasswordRow = document.getElementById('newPasswordRow');
            if (newPasswordRow.style.display === 'none') {
                newPasswordRow.style.display = 'table-row'; // แสดงแถวที่ซ่อนอยู่
            } else {
                newPasswordRow.style.display = 'none'; // ซ่อนแถว
            }
        });
        
    </script>       
              
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</body>
</html>
